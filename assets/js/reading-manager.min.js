var hametuhaReadingManager={alert:function(e){window.alert(e)},bookmarks:{},tweet:function(e){var a=jQuery("link[rel=canonical]").attr("href"),t="http://twitter.com/home?status=",n=t+encodeURIComponent("QT: "+e+" "+a+" #破滅派");window.open(n,"twitter","width=600, height=400, menubar=no, toolbar=no, scrollbars=yes").focus()},saveFrase:function(e,a,t){jQuery.post(HametuhaVars.endpoint,{action:HametuhaVars.addFavorite,_wpnonce:HametuhaVars.nonce,post_id:e,location:t,frase:a},function(e){var a=e.status?"テキストをお気に入りに登録しました。":"ごめんなさい、エラーが起きたためお気に入りに登録できませんでした。";hametuhaReadingManager.getContainer().showNotification(a)})},addReview:function(e){jQuery.fancybox.open({href:HametuhaVars.feedbackURL+"&post_id="+e,title:"作品を評価する"},{type:"iframe",width:700})},isOpen:function(){return"-100%"!=jQuery("#reading-container").css("left")},toggleMetaPanel:function(e){e&&e.preventDefault();var a;switch(jQuery(this).attr("id")){case"meta-drawer":a="-100%";break;default:a=0}jQuery("#reading-container").css({left:a})},search:function(e){this.getContainer().searchContent(e)},getContainer:function(){return-1!=navigator.appName.indexOf("Microsoft")?window.reader:document.reader},fitHeight:function(){var e=jQuery("body").hasClass("mobile")?window.innerHeight:jQuery(window).height();jQuery("#reading-container").css("height",e-(jQuery("#wpadminbar").height()+jQuery("#post-feedback").height())),jQuery("body").hasClass("mobile")&&jQuery("#reading-container .inner").css("height",jQuery("#reading-container").height()-100)},embed:function(){swfobject.embedSWF(HametuhaVars.swf,"reader","100%","100%","10.2.0",HametuhaVars.expressInstall,{endpoint:HametuhaVars.endpoint,userID:HametuhaVars.userID,postID:HametuhaVars.postID,getContent:HametuhaVars.getContent,postTitle:HametuhaVars.postTitle,postAuthor:HametuhaVars.postAuthor,fontURL:HametuhaVars.fontSwf,isPreview:HametuhaVars.isPreview},{wmode:"transparent",quality:"AUTOHIGH",allowScriptAccess:"always",allowFullScreen:!0})},width:0,curPage:1,totalPage:0,pageWidth:0,startTime:0,startX:0,latestX:0,setupPagenation:function(){this.curPage=1,this.width=jQuery("#reading-container .post-content").width(),this.pageWidth=jQuery("#reading-container .inner").width(),this.totalPage=jQuery("#reading-container .post-content").width()/this.pageWidth},movePos:function(e){e=Math.max(1,e),jQuery("#reading-container .inner").scrollLeft(this.width-(e-1)*this.pageWidth),this.curPage=e},nextPage:function(){this.curPage++,this.movePos(this.curPage)},prevPage:function(){this.curPage--,this.curPage<1?this.curPage=1:this.movePos(this.curPage)},touchStart:function(e){hametuhaReadingManager.startTime=(new Date).getTime(),hametuhaReadingManager.startX=hametuhaReadingManager.latestX=e.originalEvent.touches[0].pageX,jQuery("#reading-container .inner").bind("touchmove",hametuhaReadingManager.touchMove)},touchMove:function(e){hametuhaReadingManager.latestX=e.originalEvent.touches[0].pageX},touchEnd:function(e){jQuery("#reading-container .inner").unbind("touchmove",hametuhaReadingManager.touchMove),moved=hametuhaReadingManager.latestX-hametuhaReadingManager.startX,passed=(new Date).getTime()-hametuhaReadingManager.startTime,passed>1999||Math.abs(moved)<window.innerWidth/2}};jQuery(document).ready(function($){if($("#reading-container").length>0){var e=$(".single-post-content").remove();$("#meta-drawer, #meta-opener").click(hametuhaReadingManager.toggleMetaPanel),$("#search").focus(function(e){$(this).parents("form").addClass("active")}),$("#search").blur(function(e){$(this).parents("form").removeClass("active")}),$("#search-box").submit(function(e){e.preventDefault();var a=$("#search").val();a.length>0&&hametuhaReadingManager.search(a)});var a=setInterval(function(){var e=parseInt($("#reader-open-indicator strong").text())-1;return 0>e?($("#reader-open-indicator").remove(),clearInterval(a),void(hametuhaReadingManager.isOpen()||hametuhaReadingManager.toggleMetaPanel(!1))):void $("#reader-open-indicator strong").text(e)},1e3);hametuhaReadingManager.fitHeight(),jQuery(window).resize(function(e){hametuhaReadingManager.fitHeight()}),$("body").hasClass("mobile")?($("#reading-container .inner").append(e),setTimeout(function(){window.scrollTo(0,1),hametuhaReadingManager.fitHeight()},100),$(window).scroll(hametuhaReadingManager.fitHeight),hametuhaReadingManager.setupPagenation(),hametuhaReadingManager.movePos(1)):hametuhaReadingManager.embed()}});