!function(t){"use strict";function e(e){e||(e=200),a&&clearTimeout(a),a=setTimeout(function(){var e=t(window).height(),a=t(".container--hameditor"),n=t(".mce-edit-area iframe"),o=n.height(),i=e-a.outerHeight();n.height(o+i-1)},e)}var a;t(document).ready(function(){var a=setInterval(function(){t(".mce-edit-area iframe").length&&(clearInterval(a),e(20))},100);t("#quit-editting").click(function(e){e.preventDefault();var a=t(this).attr("href");Hametuha.confirm("編集をやめてこのページを移動しますか？ 保存していない変更は失われます。",function(){window.location.href=a})})}),t(window).on("resize",function(){e()}),t(document).ready(function(){angular.module("hametuha",["ui.bootstrap"]).filter("i18n",[function(){return function(t,e){switch(e){case"postStatus":switch(t.toLowerCase()){case"publish":return"公開済み";case"future":return"公開予約";case"private":return"非公開";case"auto-draft":case"draft":return"下書き";case"pending":return"レビュー待ち";default:return t}break;case"postStatusLabel":switch(t.toLowerCase()){case"publish":case"future":return"success";case"private":return"danger";case"pending":return"warning";default:return"default"}break;default:return t}}}]).directive("postStatus",function(){return{restrict:"E",replace:!0,scope:{status:"@"},templateUrl:Hametuha.template("post-status.html")}}).directive("postPublisher",["$uibModal",function(t){return{restrict:"E",replace:!1,scope:{postDate:"=",postStatus:"@",postCallback:"@"},templateUrl:Hametuha.template("post-publisher.html"),link:function(e,a,n){e.ask=function(){var e=t.open({animation:!0,templateUrl:Hametuha.template("post-date-selector.html"),controller:"postDateSelector",size:"sm"});e.result.then(function(t){},function(){})}}}}]).controller("postDateSelector",["$scope","$uibModalInstance",function(t,e){t.type="",t.errorMsg="",t.ok=function(){t.errorMsg="だめじゃん"},t.cancel=function(){t.errorMsg="",e.dismiss("cancel")}}]).controller("hameditor",["$scope","$http","$timeout",function(e,a,n){function o(t,e,n){var o={method:t,url:wpApiSettings.root+e,headers:{"X-WP-Nonce":wpApiSettings.nonce}};if(n)switch(t){case"POST":case"PUT":o.data=n;break;default:o.params=n}return a(o)}function i(){t(".hameditor__actions").addClass("hameditor__actions--loading")}function r(){t(".hameditor__actions").removeClass("hameditor__actions--loading")}function s(t){Hametuha.alert(t.data.message,!0)}function u(a){return a.title=e.post.title,tinyMCE.activeEditor.save(),a.content=t("#hamce").val(),a.cat={taxonomy:"anpi_cat",term_id:e.post.cat},a}e.post=HameditorPost,HameditorPost.categories.forEach(function(t){t.active&&(e.post.cat=t.id)}),e.save=function(){i();var t=(new Date).toISOString();o("POST","wp/v2/"+e.post.type+"/"+e.post.id,u({modified:t})).then(function(a){e.post.modified=t,e.post.url=a.data.link,Hametuha.alert("保存しました。","success",2e3)},s).then(r)},e.publish=function(){Hametuha.confirm("公開してよろしいですか？",function(){i();var t=(new Date).toISOString();o("POST","wp/v2/"+e.post.type+"/"+e.post.id,u({status:"publish",date:t})).then(function(a){e.post.status="publish",e.post.modified=t,e.post.date=t,e.post.url=a.data.link,Hametuha.alert("安否情報を公開しました！","success",2e3)},s).then(r)})},e["private"]=function(){i(),o("POST","wp/v2/"+e.post.type+"/"+e.post.id,u({status:"private"})).then(function(t){e.post.status="private",e.post.url=t.data.link,Hametuha.alert("投稿を非公開にしました。","warning",2e3)},s).then(r)},e["delete"]=function(t){Hametuha.confirm("この投稿を削除してよろしいですか？ この操作は取り消せません。",function(){i(),o("DELETE","wp/v2/"+e.post.type+"/"+e.post.id).then(function(){Hametuha.alert("削除しました。一覧に移動します。","warning",2e3),n(function(){window.location.href=t},2e3)},s).then(r)},!0)}}])})}(jQuery);
//# sourceMappingURL=../map/editor/common.js.map
