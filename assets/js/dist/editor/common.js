!function(o){"use strict";var e;function a(t){t||(t=200),e&&clearTimeout(e),e=setTimeout(function(){var t=o(window).height(),e=o(".container--hameditor"),a=o(".mce-edit-area iframe"),n=a.height(),i=t-e.outerHeight();a.height(n+i-1)},t)}o(document).ready(function(){var t=setInterval(function(){o(".mce-edit-area iframe").length&&(clearInterval(t),a(20))},100);o("#quit-editting").click(function(t){t.preventDefault();var e=o(this).attr("href");Hametuha.confirm("編集をやめてこのページを移動しますか？ 保存していない変更は失われます。",function(){window.location.href=e})})}),o(window).on("resize",function(){a()})}(jQuery),angular.module("hametuha").filter("i18n",[function(){"use strict";return function(t,e){switch(e){case"postStatus":switch(t.toLowerCase()){case"publish":return"公開済み";case"future":return"公開予約";case"private":return"非公開";case"auto-draft":case"draft":return"下書き";case"pending":return"レビュー待ち";default:return t}break;case"postStatusLabel":switch(t.toLowerCase()){case"publish":case"future":return"success";case"private":return"danger";case"pending":return"warning";default:return"default"}break;default:return t}}}]).directive("postStatus",function(){"use strict";return{restrict:"E",replace:!0,scope:{status:"@"},templateUrl:Hametuha.template("post-status.html")}}).directive("postPublisher",["$uibModal",function(n){"use strict";return{restrict:"E",replace:!1,scope:{postDate:"=",postStatus:"@",postCallback:"@"},templateUrl:Hametuha.template("post-publisher.html"),link:function(t,e,a){t.ask=function(){n.open({animation:!0,templateUrl:Hametuha.template("post-date-selector.html"),controller:"postDateSelector",size:"sm"}).result.then(function(t){},function(){})}}}}]).controller("postDateSelector",["$scope","$uibModalInstance",function(t,e){"use strict";t.type="",t.errorMsg="",t.ok=function(){t.errorMsg="だめじゃん"},t.cancel=function(){t.errorMsg="",e.dismiss("cancel")}}]).controller("hametuhaEditor",["$scope","$http","$timeout",function(a,i,e){"use strict";function n(t,e,a){var n={method:t,url:wpApiSettings.root+e,headers:{"X-WP-Nonce":wpApiSettings.nonce}};if(a)switch(t){case"POST":case"PUT":n.data=a;break;default:n.params=a}return i(n)}function o(){$(".hameditor__actions").addClass("hameditor__actions--loading")}function r(){$(".hameditor__actions").removeClass("hameditor__actions--loading")}function s(t){Hametuha.alert(t.data.message,!0)}function t(t){return t.title=a.post.title,tinyMCE.activeEditor.save(),t.content=$("#hamce").val(),t.cat={taxonomy:"anpi_cat",term_id:a.post.cat},t}a.post=HameditorPost,HameditorPost.categories.forEach(function(t){t.active&&(a.post.cat=t.id)}),a.save=function(){o();var e=(new Date).toISOString();n("POST","wp/v2/"+a.post.type+"/"+a.post.id,t({modified:e})).then(function(t){a.post.modified=e,a.post.url=t.data.link,Hametuha.alert("保存しました。","success",2e3)},s).then(r)},a.publish=function(){Hametuha.confirm("公開してよろしいですか？",function(){o();var e=(new Date).toISOString();n("POST","wp/v2/"+a.post.type+"/"+a.post.id,t({status:"publish",date:e})).then(function(t){a.post.status="publish",a.post.modified=e,a.post.date=e,a.post.url=t.data.link,Hametuha.alert("安否情報を公開しました！","success",2e3)},s).then(r)})},a.private=function(){o(),n("POST","wp/v2/"+a.post.type+"/"+a.post.id,t({status:"private"})).then(function(t){a.post.status="private",a.post.url=t.data.link,Hametuha.alert("投稿を非公開にしました。","warning",2e3)},s).then(r)},a.delete=function(t){Hametuha.confirm("この投稿を削除してよろしいですか？ この操作は取り消せません。",function(){o(),n("DELETE","wp/v2/"+a.post.type+"/"+a.post.id).then(function(){Hametuha.alert("削除しました。一覧に移動します。","warning",2e3),e(function(){window.location.href=t},2e3)},s).then(r)},!0)}}]);
//# sourceMappingURL=../map/editor/common.js.map
