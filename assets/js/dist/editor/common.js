!function(t){"use strict";function e(e){e||(e=200),a&&clearTimeout(a),a=setTimeout(function(){var e=t(window).height(),a=t(".container--hameditor"),n=t(".mce-edit-area iframe"),i=n.height(),o=e-a.outerHeight();n.height(i+o-1)},e)}var a;t(document).ready(function(){var a=setInterval(function(){t(".mce-edit-area iframe").length&&(clearInterval(a),e(20))},100);t("#quit-editting").click(function(e){e.preventDefault();var a=t(this).attr("href");Hametuha.confirm("編集をやめてこのページを移動しますか？ 保存していない変更は失われます。",function(){window.location.href=a})})}),t(window).on("resize",function(){e()})}(jQuery),angular.module("hametuha").filter("i18n",[function(){"use strict";return function(t,e){switch(e){case"postStatus":switch(t.toLowerCase()){case"publish":return"公開済み";case"future":return"公開予約";case"private":return"非公開";case"auto-draft":case"draft":return"下書き";case"pending":return"レビュー待ち";default:return t}break;case"postStatusLabel":switch(t.toLowerCase()){case"publish":case"future":return"success";case"private":return"danger";case"pending":return"warning";default:return"default"}break;default:return t}}}]).directive("postStatus",function(){"use strict";return{restrict:"E",replace:!0,scope:{status:"@"},templateUrl:Hametuha.template("post-status.html")}}).directive("postPublisher",["$uibModal",function(t){"use strict";return{restrict:"E",replace:!1,scope:{postDate:"=",postStatus:"@",postCallback:"@"},templateUrl:Hametuha.template("post-publisher.html"),link:function(e,a,n){e.ask=function(){var e=t.open({animation:!0,templateUrl:Hametuha.template("post-date-selector.html"),controller:"postDateSelector",size:"sm"});e.result.then(function(t){},function(){})}}}}]).controller("postDateSelector",["$scope","$uibModalInstance",function(t,e){"use strict";t.type="",t.errorMsg="",t.ok=function(){t.errorMsg="だめじゃん"},t.cancel=function(){t.errorMsg="",e.dismiss("cancel")}}]).controller("hametuhaEditor",["$scope","$http","$timeout",function(t,e,a){"use strict";function n(t,a,n){var i={method:t,url:wpApiSettings.root+a,headers:{"X-WP-Nonce":wpApiSettings.nonce}};if(n)switch(t){case"POST":case"PUT":i.data=n;break;default:i.params=n}return e(i)}function i(){$(".hameditor__actions").addClass("hameditor__actions--loading")}function o(){$(".hameditor__actions").removeClass("hameditor__actions--loading")}function r(t){Hametuha.alert(t.data.message,!0)}function s(e){return e.title=t.post.title,tinyMCE.activeEditor.save(),e.content=$("#hamce").val(),e.cat={taxonomy:"anpi_cat",term_id:t.post.cat},e}t.post=HameditorPost,HameditorPost.categories.forEach(function(e){e.active&&(t.post.cat=e.id)}),t.save=function(){i();var e=(new Date).toISOString();n("POST","wp/v2/"+t.post.type+"/"+t.post.id,s({modified:e})).then(function(a){t.post.modified=e,t.post.url=a.data.link,Hametuha.alert("保存しました。","success",2e3)},r).then(o)},t.publish=function(){Hametuha.confirm("公開してよろしいですか？",function(){i();var e=(new Date).toISOString();n("POST","wp/v2/"+t.post.type+"/"+t.post.id,s({status:"publish",date:e})).then(function(a){t.post.status="publish",t.post.modified=e,t.post.date=e,t.post.url=a.data.link,Hametuha.alert("安否情報を公開しました！","success",2e3)},r).then(o)})},t["private"]=function(){i(),n("POST","wp/v2/"+t.post.type+"/"+t.post.id,s({status:"private"})).then(function(e){t.post.status="private",t.post.url=e.data.link,Hametuha.alert("投稿を非公開にしました。","warning",2e3)},r).then(o)},t["delete"]=function(e){Hametuha.confirm("この投稿を削除してよろしいですか？ この操作は取り消せません。",function(){i(),n("DELETE","wp/v2/"+t.post.type+"/"+t.post.id).then(function(){Hametuha.alert("削除しました。一覧に移動します。","warning",2e3),a(function(){window.location.href=e},2e3)},r).then(o)},!0)}}]);
//# sourceMappingURL=../map/editor/common.js.map
