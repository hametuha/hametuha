!function(e){var t={};function n(a){if(t[a])return t[a].exports;var s=t[a]={i:a,l:!1,exports:{}};return e[a].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(a,s,function(t){return e[t]}.bind(null,s));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}({6:function(e,t,n){e.exports=n(7)},7:function(e,t){
/*!
 * wpdeps=hb-components-loading,wp-api-fetch,hashboard-rest,hb-components-pagination, hb-filters-moment
 */
var n=jQuery;Vue.component("hametuha-request",{template:'\n    <li class="hametuha-request-item list-group-item">\n        <div class="d-flex w-100 justify-content-between mb-1">\n          <h5>共同編集者としての招待</h5>\n          <small>{{ request.updated | moment( \'lll\' ) }}</small>\n        </div>\n        <p class="mb-1 text-muted">\n           作品集『<a :href="request.permalink">{{request.post_title}}</a>』に {{request.name}}さんが（{{request.label}}）として\n           <span v-if="approved"><strong>参加中</strong>です。</span>\n           <span v-else>招待を受け付けています。</span>\n           報酬はロイヤリティの <strong>{{ revenue }}%</strong> です。\n        </p>\n        <p class="text-muted text-right">\n            <small class="badge badge-light">アクション</smallc>\n        </p>\n        <p class="text-right hametuha-request-actions">\n            <button v-for="btn in actions" :class="btn.className" :key="btn.method" @click="handleClick( btn.method )">\n                {{ btn.label }}\n            </button>\n        </p>\n    </li>\n  ',props:{type:{type:String,default:""},request:{type:Object,default:{}}},computed:{approved:function(){return this.request.ratio>=0},revenue:function(){return Math.abs(parseInt(this.request.ratio,10))},actions:function(){var e=[];return this.approved||e.push({label:"承諾する",method:"approve",className:"btn btn-success btn-sm"}),e.push({label:"辞退する",method:"delete",className:"btn btn-danger btn-sm"}),e}},mounted:function(){},methods:{handleClick:function(e){switch(e){case"approve":this.$emit("request-approved",this.request.id,this.request.post_id);break;case"delete":window.confirm("辞退してもよろしいですか？　この操作は取り消せません。")&&this.$emit("request-denied",this.request.id,this.request.post_id);break;default:console&&console.log("Undefined method '".concat(e,"' is invoked."))}}}}),new Vue({el:"#hametuha-requests",template:'\n    <div class="hametuha-hb-request-list" data-loading-wrapper="true" style="position: relative;">\n      <div v-if="total">\n        <p class="text-muted text-right">{{curPage}} / {{total}}ページ</p>\n      </div>\n      <ul v-if="requests.length" class="notification-loop-container list-group">\n        <hametuha-request class="notification-loop" v-for="request in requests" :request="request" :type="type" @request-approved="approvedHandler" @request-denied="deniedHandler"></hametuha-request>\n      </ul>\n      <div v-else-if="!loading" class="alert alert-secondary">\n        <p>リクエストはありません。</p>\n      </div>\n      <hb-pagination v-if="total > 1" :total="total" :current="curPage" @pageChanged="pagination"></hb-pagination>\n      <hb-loading :loading="loading" title="読み込み中……"></hb-loading>\n    </div>',data:{type:"",curPage:1,total:0,loading:!1,requests:[]},props:{type:{type:String,required:!0}},beforeMount:function(){this.type=this.$el.getAttribute("data-type")},mounted:function(){this.fetch(1)},methods:{fetch:function(e){var t=this;this.loading=!0,wp.apiFetch({path:"/hametuha/v1/collaborators/invitations/me?paged=".concat(e),parse:!1}).then(function(n){return t.curPage=e,t.total=n.headers.get("X-WP-Total-Pages"),n.json()}).then(function(e){t.requests=e}).catch(function(e){e.json().then(function(e){n.hbErrorMessage(e.message)}).catch(function(e){n.hbErrorMessage("エラーが発生しました。")})}).finally(function(){t.loading=!1})},pagination:function(e){this.fetch(e)},approvedHandler:function(e,t){var a=this;this.loading=!0,wp.apiFetch({path:"hametuha/v1/collaborators/invitations/me",method:"POST",data:{series_id:t}}).then(function(e){n.hbMessage(e.message,"success"),a.fetch(a.curPage)}).catch(function(e){var t="エラーが発生しました。";e.message&&(t+=e.message),n.hbErrorMessage(t)}).finally(function(e){a.loading=!1})},deniedHandler:function(e,t){var a=this;this.loading=!0,wp.apiFetch({path:"hametuha/v1/collaborators/invitations/me",method:"DELETE",data:{series_id:t}}).then(function(e){n.hbMessage(e.message,"success"),a.fetch(a.curPage)}).catch(function(e){var t="エラーが発生しました。";e.message&&(t+=e.message),n.hbErrorMessage(t)}).finally(function(e){a.loading=!1})}}})}});
//# sourceMappingURL=requests.js.map