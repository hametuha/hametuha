{"version":3,"sources":["admin/series-helper.js"],"names":["$","change","e","val","this","$form","length","attr","find","submit","on","url","preventDefault","window","open","document","ready","$sorter","sortable","axis","handle","opacity","placeholder","containment","update","$lis","start","each","index","li","confirm","$li","parents","post","action","_seriesordernonce","series","post_id","done","result","success","remove","Hametuha","alert","message","fail","always","jQuery"],"mappings":"CAOA,SAAWA,GACP,YAGAA,GAAE,mBAAmBC,OAAO,SAASC,GACjC,GAAIC,GAAMH,EAAEI,MAAMD,MACdE,EAAQL,EAAE,oHAIVG,GAAIG,SACJD,EAAME,KAAK,SAAUP,EAAEI,MAAMG,KAAK,kBAClCF,EAAMG,KAAK,yBAAyBL,IAAmD,YAA9CH,EAAE,mCAAmCG,MAAsB,MAAQ,OAC5GE,EAAMG,KAAK,uBAAuBL,IAAIA,GACtCE,EAAMI,YAKdT,EAAE,yBAAyBU,GAAG,QAAS,IAAK,SAASR,GACjD,GAAIS,GAAMX,EAAEI,MAAMG,KAAK,QAAU,eAAkB,aAAeP,EAAE,qCAAqCG,MAAQ,MAAQ,MACzHD,GAAEU,iBACFC,OAAOC,KAAKH,EAAKX,EAAEI,MAAMG,KAAK,aAIlCP,EAAEe,UAAUC,MAAM,WACd,GAAIC,GAAUjB,EAAE,qBAChBiB,GAAQC,UACJC,KAAM,IACNC,OAAQ,kBACRC,QAAS,GACTC,YAAa,uBACbC,YAAa,SACbC,OAAQ,WACJ,GAAIC,GAAOzB,EAAEI,MAAMI,KAAK,MACpBkB,EAAQD,EAAKnB,MACjBmB,GAAKE,KAAK,SAASC,EAAOC,GACtB7B,EAAE6B,GAAIrB,KAAK,6BAA6BL,IAAIuB,EAAQE,QAG7DlB,GAAG,QAAS,kBAAmB,SAASR,GAEvC,GADAA,EAAEU,iBACEC,OAAOiB,QAAQ,qBAAsB,CACrC,GAAIC,GAAM/B,EAAEI,MAAM4B,QAAQ,KAC1BhC,GAAEiC,KAAKhB,EAAQV,KAAK,kBAChB2B,OAAQ,cACRC,kBAAmBlB,EAAQV,KAAK,cAChC6B,OAAQnB,EAAQV,KAAK,gBACrB8B,QAASrC,EAAEI,MAAMG,KAAK,aACvB+B,KAAK,SAASC,GACTA,EAAOC,QACPT,EAAIU,SAEJC,SAASC,MAAMJ,EAAOK,SAAS,KAEpCC,KAAK,cAELC,OAAO,oBAQvBC","file":"admin/series-helper.js","sourcesContent":["/*!\n * Series edit helper\n */\n\n/*global Backbone: true*/\n/*global _: true*/\n\n(function ($) {\n    'use strict';\n\n    // 本文プレビュー\n    $('#epub-previewer').change(function(e){\n        var val = $(this).val(),\n            $form = $('<form target=\"epub-preview\">' +\n                '<input type=\"hidden\" name=\"direction\" />' +\n                '<input type=\"hidden\" name=\"post_id\" />' +\n                '</form>');\n        if( val.length ){\n            $form.attr('action', $(this).attr('data-endpoint'));\n            $form.find('input[name=direction]').val( $('input[name=orientation]:checked').val() == 'vertical' ? 'rtl' : 'ltr' );\n            $form.find('input[name=post_id]').val(val);\n            $form.submit();\n        }\n    });\n\n    // その他のプレビュー\n    $('#series-additons-list').on('click', 'a', function(e){\n        var url = $(this).attr('href') + '?direction=' + ( 'vertical' === $('input[name=\"orientation\"]:checked').val() ? 'rtl' : 'ltr' );\n        e.preventDefault();\n        window.open(url, $(this).attr('target'));\n    });\n\n    // 並び順\n    $(document).ready(function(){\n        var $sorter = $('#series-posts-list');\n        $sorter.sortable({\n            axis: 'y',\n            handle: '.dashicons-menu',\n            opacity: 0.8,\n            placeholder: \"sortable-placeholder\",\n            containment: \"parent\",\n            update: function(){\n                var $lis = $(this).find('li'),\n                    start = $lis.length;\n                $lis.each(function(index, li){\n                    $(li).find('input[name^=series_order]').val(start - index);\n                });\n            }\n        }).on('click', '.button--delete', function(e){\n            e.preventDefault();\n            if( window.confirm('この作品を作品集から除外しますか？') ){\n                var $li = $(this).parents('li');\n                $.post($sorter.attr('data-endpoint'), {\n                    action: 'series_list',\n                    _seriesordernonce: $sorter.attr('data-nonce'),\n                    series: $sorter.attr('data-post-id'),\n                    post_id: $(this).attr('data-id')\n                }).done(function(result){\n                    if( result.success ){\n                        $li.remove();\n                    }else{\n                        Hametuha.alert(result.message, true);\n                    }\n                }).fail(function(){\n                    // Do nothing\n                }).always(function(){\n                    // Do nothing\n                });\n            }\n        });\n\n    });\n\n})(jQuery);\n"],"sourceRoot":"/source/"}