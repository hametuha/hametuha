{"version":3,"sources":["admin/series-helper.js"],"names":["$","change","e","val","this","$form","length","attr","find","append","submit","remove","on","url","preventDefault","window","open","document","ready","$sorter","sortable","axis","handle","opacity","placeholder","containment","update","$lis","start","each","index","li","confirm","$li","parents","post","action","_seriesordernonce","series","post_id","done","result","success","Hametuha","alert","message","fail","always","click","removeClass","addClass","jQuery"],"mappings":";;;CAOA,SAAWA,GACP,YAGAA,GAAE,mBAAmBC,OAAO,SAASC,GACjC,GAAIC,GAAMH,EAAEI,MAAMD,MACdE,EAAQL,EAAE,oHAIVG,GAAIG,SACJD,EAAME,KAAK,SAAUP,EAAEI,MAAMG,KAAK,kBAClCF,EAAMG,KAAK,yBAAyBL,IAAmD,YAA9CH,EAAE,mCAAmCG,MAAsB,MAAQ,OAC5GE,EAAMG,KAAK,uBAAuBL,IAAIA,GACtCH,EAAE,QAAQS,OAAOJ,GACjBA,EAAMK,SACNL,EAAMM,YAKdX,EAAE,yBAAyBY,GAAG,QAAS,IAAK,SAASV,GACjD,GAAIW,GAAMb,EAAEI,MAAMG,KAAK,QAAU,eAAkB,aAAeP,EAAE,qCAAqCG,MAAQ,MAAQ,MACzHD,GAAEY,iBACFC,OAAOC,KAAKH,EAAKb,EAAEI,MAAMG,KAAK,aAGlCP,EAAEiB,UAAUC,MAAM,WAEd,GAAIC,GAAUnB,EAAE,qBAChBmB,GAAQC,UACJC,KAAM,IACNC,OAAQ,kBACRC,QAAS,GACTC,YAAa,uBACbC,YAAa,SACbC,OAAQ,WACJ,GAAIC,GAAO3B,EAAEI,MAAMI,KAAK,MACpBoB,EAAQD,EAAKrB,MACjBqB,GAAKE,KAAK,SAASC,EAAOC,GACtB/B,EAAE+B,GAAIvB,KAAK,6BAA6BL,IAAIyB,EAAQE,QAG7DlB,GAAG,QAAS,kBAAmB,SAASV,GAEvC,GADAA,EAAEY,iBACEC,OAAOiB,QAAQ,qBAAsB,CACrC,GAAIC,GAAMjC,EAAEI,MAAM8B,QAAQ,KAC1BlC,GAAEmC,KAAKhB,EAAQZ,KAAK,kBAChB6B,OAAQ,cACRC,kBAAmBlB,EAAQZ,KAAK,cAChC+B,OAAQnB,EAAQZ,KAAK,gBACrBgC,QAASvC,EAAEI,MAAMG,KAAK,aACvBiC,KAAK,SAASC,GACTA,EAAOC,QACPT,EAAItB,SAEJgC,SAASC,MAAMH,EAAOI,SAAS,KAEpCC,KAAK,cAELC,OAAO,iBAMlB/C,EAAG,iBAAkBgD,MAAM,WAClBhD,EAAEI,MAAMG,KAAK,WACdP,EAAE,qBAAqBiD,YAAY,UAEnCjD,EAAE,qBAAqBkD,SAAS,eAO7CC","file":"../../admin/series-helper.js","sourcesContent":["/*!\n * Series edit helper\n */\n\n/*global Backbone: true*/\n/*global _: true*/\n\n(function ($) {\n    'use strict';\n\n    // 本文プレビュー\n    $('#epub-previewer').change(function(e){\n        var val = $(this).val(),\n            $form = $('<form target=\"epub-preview\">' +\n                '<input type=\"hidden\" name=\"direction\" />' +\n                '<input type=\"hidden\" name=\"post_id\" />' +\n                '</form>');\n        if( val.length ){\n            $form.attr('action', $(this).attr('data-endpoint'));\n            $form.find('input[name=direction]').val( $('input[name=orientation]:checked').val() == 'vertical' ? 'rtl' : 'ltr' );\n            $form.find('input[name=post_id]').val(val);\n            $('body').append($form);\n            $form.submit();\n            $form.remove();\n        }\n    });\n\n    // その他のプレビュー\n    $('#series-additons-list').on('click', 'a', function(e){\n        var url = $(this).attr('href') + '?direction=' + ( 'vertical' === $('input[name=\"orientation\"]:checked').val() ? 'rtl' : 'ltr' );\n        e.preventDefault();\n        window.open(url, $(this).attr('target'));\n    });\n\n    $(document).ready(function(){\n        // 並び順\n        var $sorter = $('#series-posts-list');\n        $sorter.sortable({\n            axis: 'y',\n            handle: '.dashicons-menu',\n            opacity: 0.8,\n            placeholder: \"sortable-placeholder\",\n            containment: \"parent\",\n            update: function(){\n                var $lis = $(this).find('li'),\n                    start = $lis.length;\n                $lis.each(function(index, li){\n                    $(li).find('input[name^=series_order]').val(start - index);\n                });\n            }\n        }).on('click', '.button--delete', function(e){\n            e.preventDefault();\n            if( window.confirm('この作品を作品集から除外しますか？') ){\n                var $li = $(this).parents('li');\n                $.post($sorter.attr('data-endpoint'), {\n                    action: 'series_list',\n                    _seriesordernonce: $sorter.attr('data-nonce'),\n                    series: $sorter.attr('data-post-id'),\n                    post_id: $(this).attr('data-id')\n                }).done(function(result){\n                    if( result.success ){\n                        $li.remove();\n                    }else{\n                        Hametuha.alert(result.message, true);\n                    }\n                }).fail(function(){\n                    // Do nothing\n                }).always(function(){\n                    // Do nothing\n                });\n            }\n        });\n        // 希望小売価格\n        $( '#change-price' ).click(function(){\n            if ( $(this).attr('checked') ) {\n                $('#change-price-box').removeClass('hidden');\n            } else {\n                $('#change-price-box').addClass('hidden');\n            }\n        });\n\n    });\n\n\n})(jQuery);\n"]}