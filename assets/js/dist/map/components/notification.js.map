{"version":3,"sources":["components/notification.js"],"names":["$","document","ready","$list","$link","find","updateNew","max","checked","parseInt","attr","each","index","elt","Math","removeClass","addClass","length","setInterval","get","HametuhaNotification","retrieve","_wpnonce","nonce","done","result","$divider","prevAll","remove","i","l","before","on","post","endpoint","jQuery"],"mappings":"CAMA,SAAWA,GACP,aAEAA,EAAEC,UAAUC,MAAM,WACd,IAAIC,EAAQH,EAAE,sBACVI,EAAQD,EAAME,KAAK,qBAIvB,SAASC,IACL,IAAIC,EAAM,EACNC,EAAUC,SAASL,EAAMM,KAAK,qBAAsB,IACxDP,EAAME,KAAK,iBAAiBM,KAAK,SAASC,EAAOC,GAC7CN,EAAMO,KAAKP,IAAIA,EAAKE,SAAST,EAAEa,GAAKH,KAAK,aAAc,OAE7CH,EAAVC,EACAJ,EAAMW,YAAY,cAElBX,EAAMY,SAAS,cAKnBb,EAAMc,SAENX,IAGAY,YAAY,WACRlB,EAAEmB,IAAIC,qBAAqBC,SAAU,CACjCC,SAAUF,qBAAqBG,QAChCC,KAAK,SAASC,GACb,GAAIA,EAAOR,OAAQ,CACf,IAAIS,EAAWvB,EAAME,KAAK,YAC1BqB,EAASC,QAAQ,MAAMC,SACvB,IAAK,IAAIC,EAAI,EAAGC,EAAIL,EAAOR,OAAQY,EAAIC,EAAGD,IACtCH,EAASK,OAAO/B,EAAEyB,EAAOI,KAGjCvB,OAEL,MAGHH,EAAM6B,GAAG,mBAAoB,WACzBhC,EAAEiC,KAAKb,qBAAqBc,SAAU,CAClCZ,SAAUF,qBAAqBG,QAChCC,KAAK,SAASC,GACbrB,EAAMM,KAAK,oBAAqBe,EAAOjB,SACvCF,WAjDpB,CA0DG6B","file":"../../components/notification.js","sourcesContent":["/**\n * Description\n */\n\n/*global HametuhaNotification: true*/\n\n(function ($) {\n    'use strict';\n\n    $(document).ready(function(){\n        var $list = $('#notification-link'),\n            $link = $list.find('a.dropdown-toggle');\n        // Check if latest info exists\n\n\n        function updateNew(){\n            var max = 0,\n                checked = parseInt($link.attr('data-last-checked'), 10);\n            $list.find('li[data-time]').each(function(index, elt){\n                max = Math.max(max, parseInt($(elt).attr('data-time'), 10));\n            });\n            if( checked > max ){\n                $link.removeClass('has-notify');\n            }else{\n                $link.addClass('has-notify');\n            }\n        }\n\n\n        if( $list.length ){\n\n            updateNew();\n            \n            // Check notice every 10 seconds\n            setInterval(function(){\n                $.get(HametuhaNotification.retrieve, {\n                    _wpnonce: HametuhaNotification.nonce\n                }).done(function(result){\n                    if( result.length ){\n                        var $divider = $list.find(\".divider\");\n                        $divider.prevAll('li').remove();\n                        for( var i = 0, l = result.length; i < l; i++){\n                            $divider.before($(result[i]));\n                        }\n                    }\n                    updateNew();\n                });\n            }, 15000);\n\n            // If opened, update show time.\n            $list.on('show.bs.dropdown', function(){\n                $.post(HametuhaNotification.endpoint, {\n                    _wpnonce: HametuhaNotification.nonce\n                }).done(function(result){\n                    $link.attr('data-last-checked', result.checked);\n                    updateNew();\n                });\n            });\n\n        }\n\n\n    });\n\n})(jQuery);\n"]}