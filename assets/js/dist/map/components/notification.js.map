{"version":3,"sources":["components/notification.js"],"names":["$","document","ready","updateNew","max","checked","parseInt","$link","attr","$list","find","each","index","elt","Math","removeClass","addClass","length","setInterval","get","HametuhaNotification","retrieve","_wpnonce","nonce","done","result","$divider","prevAll","remove","i","l","before","on","post","endpoint","jQuery"],"mappings":"CAMA,SAAWA,GACP,YAEAA,GAAEC,UAAUC,MAAM,WAMd,QAASC,KACL,GAAIC,GAAM,EACNC,EAAUC,SAASC,EAAMC,KAAK,qBAAsB,GACxDC,GAAMC,KAAK,iBAAiBC,KAAK,SAASC,EAAOC,GAC7CT,EAAMU,KAAKV,IAAIA,EAAKE,SAASN,EAAEa,GAAKL,KAAK,aAAc,OAEvDH,EAAUD,EACVG,EAAMQ,YAAY,cAElBR,EAAMS,SAAS,cAdvB,GAAIP,GAAQT,EAAE,sBACVO,EAAQE,EAAMC,KAAK,oBAkBnBD,GAAMQ,SAENd,IAGAe,YAAY,WAERlB,EAAEmB,IAAIC,qBAAqBC,UACvBC,SAAUF,qBAAqBG,QAChCC,KAAK,SAASC,GACb,GAAIA,EAAOR,OAAQ,CACf,GAAIS,GAAWjB,EAAMC,KAAK,WAC1BgB,GAASC,QAAQ,MAAMC,QACvB,KAAK,GAAIC,GAAI,EAAGC,EAAIL,EAAOR,OAAQY,EAAIC,EAAGD,IACtCH,EAASK,OAAO/B,EAAEyB,EAAOI,KAGjC1B,OAEL,MAGHM,EAAMuB,GAAG,mBAAoB,WACzBhC,EAAEiC,KAAKb,qBAAqBc,UACxBZ,SAAUF,qBAAqBG,QAChCC,KAAK,SAASC,GACblB,EAAMC,KAAK,oBAAqBiB,EAAOpB,SACvCF,YASjBgC","file":"../../components/notification.js","sourcesContent":["/**\n * Description\n */\n\n/*global HametuhaNotification: true*/\n\n(function ($) {\n    'use strict';\n\n    $(document).ready(function(){\n        var $list = $('#notification-link'),\n            $link = $list.find('a.dropdown-toggle');\n        // Check if latest info exists\n\n\n        function updateNew(){\n            var max = 0,\n                checked = parseInt($link.attr('data-last-checked'), 10);\n            $list.find('li[data-time]').each(function(index, elt){\n                max = Math.max(max, parseInt($(elt).attr('data-time'), 10));\n            });\n            if( checked > max ){\n                $link.removeClass('has-notify');\n            }else{\n                $link.addClass('has-notify');\n            }\n        }\n\n\n        if( $list.length ){\n\n            updateNew();\n            \n            // Check notice every 10 seconds\n            setInterval(function(){\n\n                $.get(HametuhaNotification.retrieve, {\n                    _wpnonce: HametuhaNotification.nonce\n                }).done(function(result){\n                    if( result.length ){\n                        var $divider = $list.find(\".divider\");\n                        $divider.prevAll('li').remove();\n                        for( var i = 0, l = result.length; i < l; i++){\n                            $divider.before($(result[i]));\n                        }\n                    }\n                    updateNew();\n                });\n            }, 15000);\n\n            // If opened, update show time.\n            $list.on('show.bs.dropdown', function(){\n                $.post(HametuhaNotification.endpoint, {\n                    _wpnonce: HametuhaNotification.nonce\n                }).done(function(result){\n                    $link.attr('data-last-checked', result.checked);\n                    updateNew();\n                });\n            });\n\n        }\n\n\n    });\n\n})(jQuery);\n"]}