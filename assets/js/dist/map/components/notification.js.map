{"version":3,"sources":["components/notification.js"],"names":["$","document","ready","$list","$link","find","updateNew","max","checked","parseInt","attr","each","index","elt","Math","removeClass","addClass","length","setInterval","get","HametuhaNotification","retrieve","_wpnonce","nonce","done","result","$divider","prevAll","remove","i","l","before","on","post","endpoint","jQuery"],"mappings":"CAMA,SAAWA,GACT,aAEAA,EAAEC,UAAUC,MAAM,WAChB,IAAIC,EAAQH,EAAE,sBACZI,EAAQD,EAAME,KAAK,qBAGrB,SAASC,IACP,IAAIC,EAAM,EACRC,EAAUC,SAASL,EAAMM,KAAK,qBAAsB,IACtDP,EAAME,KAAK,iBAAiBM,KAAK,SAAUC,EAAOC,GAChDN,EAAMO,KAAKP,IAAIA,EAAKE,SAAST,EAAEa,GAAKH,KAAK,aAAc,OAE3CH,EAAVC,EACFJ,EAAMW,YAAY,cAElBX,EAAMY,SAAS,cAKfb,EAAMc,SAERX,IAGAY,YAAY,WACVlB,EAAEmB,IAAIC,qBAAqBC,SAAU,CACnCC,SAAUF,qBAAqBG,QAC9BC,KAAK,SAAUC,GAChB,GAAIA,EAAOR,OAAQ,CACjB,IAAIS,EAAWvB,EAAME,KAAK,YAC1BqB,EAASC,QAAQ,MAAMC,SACvB,IAAK,IAAIC,EAAI,EAAGC,EAAIL,EAAOR,OAAQY,EAAIC,EAAGD,IACxCH,EAASK,OAAO/B,EAAEyB,EAAOI,KAG7BvB,OAED,MAGHH,EAAM6B,GAAG,mBAAoB,WAC3BhC,EAAEiC,KAAKb,qBAAqBc,SAAU,CACpCZ,SAAUF,qBAAqBG,QAC9BC,KAAK,SAAUC,GAChBrB,EAAMM,KAAK,oBAAqBe,EAAOjB,SACvCF,WAhDV,CAyDG6B","file":"../../components/notification.js","sourcesContent":["/**\n * Description\n */\n\n/*global HametuhaNotification: true*/\n\n(function ($) {\n  'use strict';\n\n  $(document).ready(function () {\n    var $list = $('#notification-link'),\n      $link = $list.find('a.dropdown-toggle');\n\n    // Check if latest info exists\n    function updateNew() {\n      var max = 0,\n        checked = parseInt($link.attr('data-last-checked'), 10);\n      $list.find('li[data-time]').each(function (index, elt) {\n        max = Math.max(max, parseInt($(elt).attr('data-time'), 10));\n      });\n      if (checked > max) {\n        $link.removeClass('has-notify');\n      } else {\n        $link.addClass('has-notify');\n      }\n    }\n\n\n    if ($list.length) {\n\n      updateNew();\n\n      // Check notice every 10 seconds\n      setInterval(function () {\n        $.get(HametuhaNotification.retrieve, {\n          _wpnonce: HametuhaNotification.nonce\n        }).done(function (result) {\n          if (result.length) {\n            var $divider = $list.find(\".divider\");\n            $divider.prevAll('li').remove();\n            for (var i = 0, l = result.length; i < l; i++) {\n              $divider.before($(result[i]));\n            }\n          }\n          updateNew();\n        });\n      }, 15000);\n\n      // If opened, update show time.\n      $list.on('show.bs.dropdown', function () {\n        $.post(HametuhaNotification.endpoint, {\n          _wpnonce: HametuhaNotification.nonce\n        }).done(function (result) {\n          $link.attr('data-last-checked', result.checked);\n          updateNew();\n        });\n      });\n\n    }\n\n\n  });\n\n})(jQuery);\n"]}