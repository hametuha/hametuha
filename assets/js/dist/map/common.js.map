{"version":3,"sources":["common.js"],"names":["$","window","Hametuha","ga","hitEvent","category","action","label","value","nonInteraction","hitType","eventCategory","eventAction","eventLabel","eventValue","err","eventOutbound","event","url","hitCallback","Modernizr","touch","location","href","open","preventDefault","str","yakumono","startYakumono","string","this","test","alert","message","error","notify","type","placement","align","confirm","callback","deletable","bootbox","dialog","title","buttons","cancel","className","ok","isTategaki","hasClass","models","views","collections","modal","body","box","find","html","addClass","close","jQuery","document","ready","submit","attr","each","index","input","file","next","on","e","trigger","change","fileName","val","split","length","click","parents","prop","toggleClass","tooltip","container","profileNav","profileNavs","section","id","text","hasOwnProperty","append","remove","errors","elt","push","get","result","removeClass","form","ajaxSubmit","success","post","ID","reload","msg","prepend","setTimeout","listTpl","render","postId","btn","before","home_url","$box","done","brand","fail","always","target","FB","ui","method","response","fbTimer","setInterval","Event","clearInterval","actions","create","p","subscribe","socialNetwork","socialAction","socialTarget","replace","twTimer","twttr","events","i","key","bind","pathname"],"mappings":"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","file":"common.js","sourcesContent":["/* \n * 破滅派サイト全体で共通して読み込まれるファイル\n */\n\n/*global ga: true*/\n/*global FB: true*/\n/*global twttr: true*/\n\n(function ($) {\n\n    \"use strict\";\n\n    var Hametuha = window.Hametuha = {\n        ga: {\n            /**\n             * Google Analyticsのイベントを呼ぶ\n             *\n             * @param {String} category\n             * @param {String} action\n             * @param {String} label\n             * @param {...Number} value Default 1\n             * @param {...Boolean} nonInteraction Default false\n             */\n            hitEvent: function (category, action, label, value, nonInteraction) {\n                try {\n                    if ('undefined' === typeof value) {\n                        value = 1;\n                    }\n                    ga('send', {\n                        hitType       : 'event',\n                        eventCategory : category,\n                        eventAction   : action,\n                        eventLabel    : label,\n                        eventValue    : value,\n                        nonInteraction: !!nonInteraction\n                    });\n                } catch (err) {\n                }\n            },\n\n            /**\n             * URLの移動をGAに記録する\n             *\n             * @param {Event} event\n             * @param {String} url\n             * @param {String} category\n             * @param {String} action\n             * @param {String} label\n             * @param {...Number} value\n             */\n            eventOutbound: function (event, url, category, action, label, value) {\n                try {\n                    if ('undefined' === typeof value) {\n                        value = 1;\n                    }\n                    // Send event\n                    ga('send', {\n                        hitType      : 'event',\n                        eventCategory: category,\n                        eventAction  : action,\n                        eventLabel   : label,\n                        eventValue   : value,\n                        hitCallback  : function () {\n                            if (Modernizr.touch) {\n                                window.location.href = url;\n                            } else {\n\n                                if ('share' === category) {\n                                    window.open(url, 'outbound', \"width=520, height=350\");\n                                } else {\n                                    window.open(url, 'outbound');\n                                }\n                            }\n                        }\n                    });\n                    // stopEvent\n                    event.preventDefault();\n                } catch (err) {\n                }\n            }\n        },\n\n        str: {\n\n            /**\n             * 約物開始判定用正規表現\n             *\n             * @type {RegExp}\n             */\n            yakumono: /^[ 　【】《〔〝『「（”\"'’\\(\\)]/,\n\n            /**\n             * 文字列が約物で始まるかどうか\n             *\n             * @param {String} string\n             * @returns {*|boolean}\n             */\n            startYakumono: function (string) {\n                return this.yakumono.test(string);\n            }\n        },\n\n        /**\n         * グローバルメッセージを表示する\n         *\n         * @param {String} message\n         * @param {Boolean} [error]\n         */\n        alert: function (message, error) {\n            $.notify({\n                // options\n                message: message\n            }, {\n                // settings\n                type     : error ? 'danger' : 'success',\n                placement: {\n                    align: 'center'\n                }\n            });\n        },\n\n        /**\n         * Show confirm dialog\n         *\n         * @param {String} message\n         * @param {Function} [callback]\n         * @param {Boolean} [deletable]\n         */\n        confirm: function (message, callback, deletable) {\n            bootbox.dialog({\n                title  : '確認',\n                message: message,\n                buttons: {\n                    cancel: {\n                        label    : 'キャンセル',\n                        className: 'btn-default'\n                    },\n                    ok    : {\n                        label    : deletable ? '実行' : 'OK',\n                        className: deletable ? 'btn-danger' : 'btn-success',\n                        callback : callback\n                    }\n                }\n            });\n        },\n\n        /**\n         * 投稿が縦書きかどうか\n         *\n         * @returns {Boolean}\n         */\n        isTategaki: function () {\n            return $('body').hasClass('tategaki');\n        },\n\n        /**\n         * モデルを格納する名前空間\n         * @type {Object}\n         */\n        models: {},\n\n        /**\n         * ビューを格納する名前空間\n         */\n        views: {},\n\n        /**\n         * コレクションを格納する名前空間\n         */\n        collections: {},\n\n        /**\n         * モーダル関係\n         */\n        modal: {\n            /**\n             * モーダルボックスを表示する\n             *\n             * @param {String} title\n             * @param {String|Function} body\n             */\n            open : function (title, body) {\n                var box = $('#hametu-modal');\n                box.find('.modal-title').html(title);\n                if (typeof body === 'function') {\n                    //\n                    box.addClass('loading');\n                    body(box);\n                } else {\n                    // 追加して開く\n                    box.find('.modal-body').html(body);\n                }\n                box.modal('show');\n            },\n            /**\n             * モーダルボックスを閉じる\n             */\n            close: function () {\n                var box = $('#hametu-modal');\n                box.find('.modal-title').html('');\n                box.find('.modal-body').html('');\n                box.modal('hide');\n            }\n        }\n    };\n})(jQuery);\n\n\njQuery(document).ready(function ($) {\n\n    \"use strict\";\n\n    var Hametuha = window.Hametuha;\n\n    // フォームの二重送信防止\n    $('form').submit(function () {\n        $(this).find('input[type=submit]').attr('disabled', true);\n    });\n\n    // 画像のアップロード\n    $('.pseudo-uploader').each(function (index, input) {\n        var file = $(input).next('input');\n        $(input).on('click', '.btn', function (e) {\n            e.preventDefault();\n            file.trigger('click');\n        });\n        file.change(function (e) {\n            var fileName = $(this).val().split('\\\\');\n            $(input).find('input[type=text]').val(fileName[fileName.length - 1]);\n        });\n    });\n\n    // フォームのチェックを外す\n    $('.form-unlimiter').click(function (e) {\n        // チェック／アンチェックで送信ボタンを切替\n        $(this).parents('form').find('input[type=submit]').prop('disabled', !$(this).attr('checked'));\n    });\n\n    // 確認ボタン\n    $('a[data-confirm], input[data-confirm]').click(function (e) {\n        if (!(window.confirm($(this).attr('data-confirm')))) {\n            return false;\n        }\n    });\n\n    // Off canvas\n    $('[data-toggle=offcanvas]').click(function () {\n        $('body').toggleClass('offcanvas-on');\n    });\n\n    // ツールチップ\n    $('.help-tip').tooltip({\n        trigger  : 'hover focus click',\n        container: 'body'\n    });\n\n\n    // プロフィールナビ\n    var profileNav = $('#profile-navi');\n    if (profileNav.length) {\n        var profileNavs = {};\n        $('section', '#your-profile').each(function (index, section) {\n            var id = 'profile-section-' + (index + 1);\n            $(section).attr('id', id);\n            profileNavs[id] = $(section).find('h2, h3:first-child').text();\n        });\n        for (var id in profileNavs) {\n            if (profileNavs.hasOwnProperty(id)) {\n                profileNav.append('<li><a href=\"#' + id + '\">' + profileNavs[id] + '</a></li>');\n            }\n        }\n    }\n\n    // フォームバリデーション\n    $('.validator').submit(function (e) {\n        $(this).find('runtime-error').remove();\n        var errors = [];\n        $(this).find('.required').each(function (index, elt) {\n            if (!$(elt).val()) {\n                $(elt).addClass('erro');\n                var label = $('label[for=' + $(elt).attr('id') + ']', this);\n                if (label.length) {\n                    errors.push(label.text() + 'は必須項目です。');\n                }\n            }\n        });\n        if (errors.length) {\n            e.preventDefault();\n        }\n    });\n\n    // リスト作成用モーダル\n    $(document).on('click', 'a.list-creator', function (e) {\n        e.preventDefault();\n        var url = $(this).attr('href');\n        Hametuha.modal.open($(this).attr('title'), function (box) {\n            $.get(url, {}, function (result) {\n                box.removeClass('loading');\n                box.find('.modal-body').html(result.html);\n            });\n        });\n    });\n\n    // リスト作成フォーム\n    $(document).on('submit', '.list-create-form', function (e) {\n        e.preventDefault();\n        var form = $(this);\n        form.addClass('loading');\n        form.ajaxSubmit({\n            success: function (result) {\n                if (result.success) {\n                    form.trigger('created.hametuha', [result.post]);\n                } else {\n                    Hametuha.alert(result.message, true);\n                }\n                form.find('input[type=submit]').attr('disabled', false);\n                form.removeClass('loading');\n            }\n        });\n    });\n\n    // モーダルの中のリスト\n    $('.modal').on('created.hametuha', '.list-create-form', function (e, post) {\n        Hametuha.modal.close();\n        Hametuha.ga.hitEvent('list', 'add', post.ID);\n        if ($('body').hasClass('single-lists')) {\n            location.reload();\n        }\n    });\n\n    // リスト追加フォーム\n    $(document).on('submit', '.list-save-manager', function (e) {\n        e.preventDefault();\n        var form = $(this);\n        form.addClass('loading');\n        form.ajaxSubmit({\n            success: function (result) {\n                form.find('input[type=submit]').attr('disabled', false);\n                form.removeClass('loading');\n                var msg = $('<div class=\"alert alert-dismissible\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\"><span aria-hidden=\"true\">&times;</span><span class=\"sr-only\">閉じる</span></button></div>');\n                msg.addClass('alert-' + ( result.success ? 'success' : 'danger' ))\n                    .append('<span>' + result.message + '</span>');\n                form.prepend(msg);\n                setTimeout(function () {\n                    msg.find('button').trigger('click');\n                }, 5000);\n            }\n        });\n    });\n\n    // リスト削除ボタン\n    $(document).on('click', '.list-eraser', function (e) {\n        e.preventDefault();\n        Hametuha.confirm($(this).attr('title'), function() {\n            $.post($(this).attr('href'), function (result) {\n                Hametuha.alert(result.message);\n                if (result.success && $('body').hasClass('single-lists')) {\n                    window.location.href = result.url;\n                }\n            });\n        }, true);\n    });\n\n    // リストから投稿を削除\n    var listTpl = $('#my-list-deleter');\n    if (listTpl.length) {\n        // ボタンを追加\n        $('ol.media-list > li').each(function (index, elt) {\n            $(elt).find('.list-inline').append(listTpl.render({\n                postId: $(elt).attr('data-post-id')\n            }));\n        });\n        // イベントリスナー\n        $('ol.media-list').on('click', '.deregister-button', function (e) {\n            e.preventDefault();\n            var btn = $(this);\n            Hametuha.confirm('リストからこの作品を削除します。この操作は取り消せませんが、よろしいですか？', function(){\n                $.post(btn.attr('href'), {}, function (result) {\n                    if (result.success) {\n                        btn.parents('li.media').remove();\n                        if (!$('ol.media-list > li').length) {\n                            $('ol.media-list').before('<div class=\"alert alert-danger\">' + result.message + '</div>');\n                            setTimeout(function () {\n                                window.location.href = result.home_url;\n                            }, 3000);\n                        }\n                    } else {\n                        Hametuha.alert(result.message, true);\n                    }\n                });\n            }, true);\n        });\n    }\n\n    // ソーシャルカウント\n    $('.row--share').each(function (index, elt) {\n        var $box = $(this);\n        $.get($box.attr('data-share-url')).done(function (result) {\n            if (result.success) {\n                for (var brand in result.result) {\n                    if (result.result.hasOwnProperty(brand)) {\n                        $box.find('a.share--' + brand + ' span').text(result.result[brand]);\n                    }\n                }\n            }\n        }).fail(function () {\n            // Do nothing\n        }).always(function () {\n            // Do nothing\n        });\n    });\n\n    // シェアボタンクリック\n    $(document).on('click', 'a.share', function (e) {\n        var ga     = window.Hametuha.ga,\n            brand  = $(this).attr('data-medium'),\n            href   = $(this).attr('href'),\n            target = $(this).attr('data-target');\n        switch (brand) {\n            case 'facebook':\n                try {\n                    FB.ui({\n                        method: 'share',\n                        href  : href\n                    }, function (response) {\n                        if (response) {\n                            ga.hitEvent('share', brand, target);\n                        }\n                    });\n                    e.preventDefault();\n                } catch (err) {\n                }\n                break;\n            case 'hatena':\n                // Do noghing\n                break;\n            default:\n                ga.eventOutbound(e, href, 'share', brand, target);\n                break;\n        }\n    });\n\n    // アウトバウンドを記録\n    $(document).on('click', 'a[data-outbound]', function (e) {\n        var url      = $(this).attr('href'),\n            category = $(this).attr('data-outbound'),\n            action   = $(this).attr('data-action'),\n            label    = $(this).attr('data-label'),\n            value    = $(this).attr('data-value') || 1;\n        if (category && action && label) {\n            Hametuha.ga.eventOutbound(event, url, category, action, label, value);\n        }\n    });\n\n    // いいねを集計\n    var fbTimer = setInterval(function () {\n        if (window.FB && window.FB.Event) {\n            clearInterval(fbTimer);\n            var actions = {\n                create: 'like',\n                remove: 'dislike'\n            };\n            for (var prop in actions) {\n                if (!actions.hasOwnProperty(prop)) {\n                    continue;\n                }\n                (function (p, action) {\n                    FB.Event.subscribe('edge.' + p, function (url) {\n                        try {\n                            ga('send', {\n                                hitType      : 'social',\n                                socialNetwork: 'facebook',\n                                socialAction : action,\n                                socialTarget : url.replace(/^https?:\\/\\/hametuha\\.(com|info)/, '')\n                            });\n                        } catch (err) {\n                        }\n                    });\n                })(prop, actions[prop]);\n            }\n        }\n    }, 100);\n\n    // つぶやきを集計\n    var twTimer = setInterval(function () {\n        if (window.twttr && window.twttr.events) {\n            clearInterval(twTimer);\n            var events = ['follow', 'tweet', 'retweet', 'click', 'favorite'];\n            for (var i = 0; i < events.length; i++) {\n                (function (key) {\n                    window.twttr.events.bind(key, function (event) {\n                        try {\n                            ga('send', {\n                                hitType      : 'social',\n                                socialNetwork: 'twitter',\n                                socialAction : key,\n                                socialTarget : window.location.pathname\n                            });\n                        } catch (err) {\n                        }\n                    });\n                })(events[i]);\n            }\n        }\n    }, 100);\n});\n"],"sourceRoot":"/source/"}