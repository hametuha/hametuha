{"version":3,"sources":["social.js"],"names":["$","d","s","id","js","fjs","document","on","e","url","this","attr","category","action","label","value","Hametuha","ga","eventOutbound","event","window","fbAsyncInit","FB","init","appId","xfbml","autoLogAppEvents","version","each","comment.create","comment.remove","edge.create","edge.remove","message.send","prop","Event","subscribe","href","hasOwnProperty","hitType","socialNetwork","socialAction","socialTarget","replace","err","getElementsByTagName","getElementById","createElement","async","src","HametuhaSocial","needChat","parentNode","insertBefore","twttr","t","_e","ready","f","push","index","key","events","bind","location","pathname","___gcfg","lang","defer","plusOneCallBack","params","timer","path","hitCallback","clearTimeout","setTimeout","preventDefault","jQuery"],"mappings":"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","file":"../social.js","sourcesContent":["/**\n * bodyタグの開始直後に読み込まれる\n */\n\n/*global FB: false*/\n/*global twttr: false*/\n/*global Hametuha: true*/\n/*global HametuhaSocial: false */\n\n(function ($) {\n\n  \"use strict\";\n\n  //\n  // アウトバウンドを記録\n  // -------------------\n  //\n  $(document).on('click', 'a[data-outbound]', function (e) {\n    var url      = $(this).attr('href'),\n        category = $(this).attr('data-outbound'),\n        action   = $(this).attr('data-action'),\n        label    = $(this).attr('data-label'),\n        value    = $(this).attr('data-value') || 1;\n    if (category && action && label) {\n      Hametuha.ga.eventOutbound(event, url, category, action, label, value);\n    }\n  });\n\n\n  //\n  // Facebook\n  // ------------------\n  //\n  window.fbAsyncInit = function () {\n    // 初期化\n    FB.init({\n      appId  : '196054397143922',\n      xfbml  : true,\n      autoLogAppEvents : true,\n      version: 'v3.2'\n    });\n    // イベントを監視\n    var actions = {\n      'comment.create': 'comment',\n      'comment.remove': 'uncomment',\n      'edge.create': 'like',\n      'edge.remove': 'dislike',\n      'message.send': 'message'\n    };\n    $.each(actions, function (prop, action) {\n      FB.Event.subscribe( prop, function (url) {\n        var href = url.hasOwnProperty('href') ? url.href : url;\n        try {\n          ga('send', {\n            hitType      : 'social',\n            socialNetwork: 'facebook',\n            socialAction : action,\n            socialTarget : href.replace(/^https?:\\/\\/hametuha\\.(com|info)/, '')\n          });\n        } catch (err) {\n        }\n      });\n    });\n  };\n  (function (d, s, id) {\n    var js, fjs = d.getElementsByTagName(s)[0];\n    if (d.getElementById(id)) return;\n    js = d.createElement(s);\n    js.id = id;\n    js.async = true;\n    js.src = HametuhaSocial.needChat ? '//connect.facebook.net/ja_JP/sdk/xfbml.customerchat.js' : \"//connect.facebook.net/ja_JP/sdk.js\";\n    fjs.parentNode.insertBefore(js, fjs);\n  }(document, 'script', 'facebook-jssdk'));\n\n\n\n  //\n  // Twitter\n  // ---------------\n  //\n  window.twttr = (function (d, s, id) {\n    var js, fjs = d.getElementsByTagName(s)[0],\n        t       = window.twttr || {};\n    if (d.getElementById(id)) return;\n    js = d.createElement(s);\n    js.id = id;\n    js.src = \"https://platform.twitter.com/widgets.js\";\n    js.async = true;\n    fjs.parentNode.insertBefore(js, fjs);\n\n    t._e = [];\n    t.ready = function (f) {\n      t._e.push(f);\n    };\n\n    return t;\n  }(document, \"script\", \"twitter-wjs\"));\n\n  // つぶやきを集計\n  twttr.ready(function (twttr) {\n    $.each(['follow', 'tweet', 'retweet', 'click', 'favorite'], function (index, key) {\n      twttr.events.bind(key, function (event) {\n        try {\n          ga('send', {\n            hitType      : 'social',\n            socialNetwork: 'twitter',\n            socialAction : key,\n            socialTarget : window.location.pathname\n          });\n        } catch (err) {\n          // Do nothing\n        }\n      });\n    });\n  });\n\n\n\n  //\n  // はてな\n  // ---------------\n  //\n  (function (d, s, id) {\n    var js, fjs = d.getElementsByTagName(s)[0];\n    if (d.getElementById(id)) return;\n    js = d.createElement(s);\n    js.id = id;\n    js.src = \"https://b.st-hatena.com/js/bookmark_button.js\";\n    js.async = true;\n    fjs.parentNode.insertBefore(js, fjs);\n  }(document, \"script\", \"hatena-js\"));\n\n\n\n  //\n  // Google\n  // ---------------\n  //\n  (function (d, s, id) {\n    var js, fjs = d.getElementsByTagName(s)[0];\n    if (d.getElementById(id)) return;\n    window.___gcfg = {\n      lang: 'ja'\n    };\n    js = d.createElement(s);\n    js.id = id;\n    js.src = \"https://apis.google.com/js/platform.js\";\n    js.async = true;\n    js.defer = true;\n    fjs.parentNode.insertBefore(js, fjs);\n  }(document, \"script\", \"google-plus-js\"));\n  // コールバック\n  window.plusOneCallBack = function(params){\n    var status;\n  };\n\n\n\n  //\n  // LINE\n  // ---------------\n  //\n  $(document).on('click', '.share-line', function(e){\n    try{\n      var href = $(this).attr('href');\n      var path = $(this).attr('data-path');\n      var timer;\n      ga('send', {\n        hitType      : 'social',\n        socialNetwork: 'line',\n        socialAction : 'send',\n        socialTarget : path.replace(/^https?:\\/\\/hametuha\\.(com|info)/, ''),\n        hitCallback: function(){\n          clearTimeout(timer);\n          window.location.href = href;\n        }\n      });\n      timer = setTimeout(function(){\n        window.location.href = href;\n      }, 1000);\n      e.preventDefault();\n    }catch (err){\n      // Do nothing.\n    }\n  });\n\n})(jQuery);\n"]}