angular.module("hametuha").controller("ideaList",["$scope","$http",function(i,o){"use strict";var s=wpApiSettings.root+"hametuha/v1/idea/mine/";i.loading=!1,i.ideas=[],i.ideasOffset=0,i.ideasTotal=1,i.ideasMore=!0,i.query="",i.initIdeas=function(e){i.getIdeas(0)},i.getIdeas=function(e){var a={offset:e};i.query.length&&(a.s=i.query),i.loading=!0,o({method:"GET",url:s,headers:{"X-WP-Nonce":wpApiSettings.nonce},params:a}).then(function(e){i.ideasTotal=e.data.total,i.ideasOffset=e.data.offset,e.data.ideas.length?angular.forEach(e.data.ideas,function(e){i.ideas.push(e)}):(i.ideasMore=!1,Hametuha.alert("これ以上のアイデアは保存されていません。")),i.loading=!1},function(e){Hametuha.alert("アイデアを取得できませんでした",!0),i.loading=!1})},i.search=function(e){i.query=e;for(var a=i.ideas.length-1;0<=a;a--)delete i.ideas[a];i.ideas=[],i.ideasOffset=0,i.ideasTotal=1,i.ideasMore=!0,i.getIdeas(0)},i.nextIdeas=function(){i.getIdeas(i.ideasOffset+20)},i.stock=function(e){for(var a=null,t=0,n=i.ideas.length;t<n;t++)if(i.ideas[t].ID==e){a=t;break}null!==a&&(i.loading=!0,o({method:"POST",url:wpApiSettings.root+"hametuha/v1/idea/"+e+"/",headers:{"X-WP-Nonce":wpApiSettings.nonce}}).then(function(e){i.ideas[a].location=1},function(e){Hametuha.alert(e.data.message,!0)}).then(function(){i.loading=!1}))},i.unstock=function(e){for(var a=null,t=0,n=i.ideas.length;t<n;t++)if(i.ideas[t].ID==e){a=t;break}null!==a&&(i.loading=!0,Hametuha.confirm("このアイデアのストックを解除しますか？",function(){o({method:"DELETE",url:wpApiSettings.root+"hametuha/v1/idea/"+e+"/",headers:{"X-WP-Nonce":wpApiSettings.nonce}}).then(function(e){i.ideas[a].own?(i.ideas[t].location=0,i.ideas[t].stocking=!1):(i.ideas.splice(a,1),i.ideasTotal--,i.offset--)},function(e){Hametuha.alert(e.data.message,!0)}).then(function(){i.loading=!1})}))},i.removeIdea=function(n){Hametuha.confirm("このアイデアを削除してよろしいですか？",function(){for(var a=null,e=0,t=i.ideas.length;e<t;e++)if(i.ideas[e].ID==n){a=e;break}null!==a&&(i.loading=!0,o({method:"DELETE",url:s+"?post_id="+n,headers:{"X-WP-Nonce":wpApiSettings.nonce}}).then(function(e){i.ideas.splice(a,1),i.ideasTotal--,i.offset--},function(e){Hametuha.alert(e.data.message,!0)}).then(function(){i.loading=!1}))},!0)}}]);
//# sourceMappingURL=../map/components/ideas.js.map
