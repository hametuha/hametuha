Chart.defaults.global.responsive=!0,function(a){"use strict";Hametuha.views.Scroll=Backbone.View.extend({el:"#content-wrapper",events:{},tategaki:!1,scrollTop:0,ticker:null,slider:null,max:1e3,timer:0,toLast:!1,animating:!1,limit:null,initialize:function(){_.bindAll(this,"getSliderPosition","toggleScrollBind","updateTicker","tickerHandler","scrollHandler","moveTo","finishAnimate","passedTime"),this.ticker=a('<span id="slider-ticker">0%</span>'),this.tategaki=Hametuha.isTategaki(),this.slider=a("#slider"),this.limit=a("#post-author"),this.bindScroll=!0,this.scrollTop=a(window).scrollTop();var b=0;this.slider.slider({max:this.max,min:0,step:1,value:this.getSliderPosition(b),slide:this.updateTicker,change:this.updateTicker,stop:this.tickerHandler}),this.slider.find(".ui-slider-handle").append(this.ticker),a(window).on("resize scroll load",this.scrollHandler),a(window).on("toggle.scroll.hametuha",this.toggleScrollBind);var c=new Date;this.timer=c.getTime()},passedTime:function(){var a=new Date;return Math.round((a.getTime()-this.timer)/1e3)},toggleScrollBind:function(b,c){this.bindScroll=c,c&&a(window).scrollTop(this.scrollTop)},getSliderPosition:function(a){return this.tategaki?this.max-a:a},updateTicker:function(a,b){isNaN(b.value)||this.ticker.text(b.value/10+"%")},tickerHandler:function(a,b){this.moveTo(b.value/1e3)},moveTo:function(b){var c=(a(document).height()-a(window).height())*b;this.animating=!0,a("body, html").animate({scrollTop:c},"fast",this.finishAnimate)},finishAnimate:function(){this.animating=!1},scrollHandler:function(){if(this.bindScroll){this.scrollTop=a(window).scrollTop();var b=a(document).height()-a(window).height(),c=Math.min(1,Math.max(0,this.scrollTop/b)),d=this.limit.offset().top+50;this.animating||this.slider.slider("value",parseInt(1e3*c,10));var e=a("#work-end-ranker");if(!this.toLast&&d<this.scrollTop+a(window).height()&&e.length){this.toLast=!0;var f=e.attr("data-post");Hametuha.ga.hitEvent("read","complete",f),Hametuha.ga.hitEvent("read","passed",f,this.passedTime()),a("body").addClass("finish-reading")}}}}),jQuery(document).ready(function(a){a(".work-content p").each(function(b,c){Hametuha.str.startYakumono(a(c).text())||a(c).hasClass("wp-caption-text")||a(c).addClass("indent")});var b="viewing-content",c=a("#viewing-content"),d=a("#footer-single"),e=function(){c.attr("id",b).removeClass("show-nav"),a(window).trigger("toggle.scroll.hametuha",[!0])};d.on("click","a",function(f){if(f.preventDefault(),a(this).hasClass("active"))a(this).removeClass("active"),e();else{d.find("a").removeClass("active"),a(this).addClass("active");var g=a(this).attr("href").replace("#","");g.match(/reading-nav/)?c.attr("id",b).addClass("show-nav"):(c.attr("id","viewing-"+g.replace("-wrapper","")).removeClass("show-nav"),a(window).trigger("toggle.scroll.hametuha",[!1]),a(window).scrollTop(0))}}),a(".reset-viewer").click(function(a){a.preventDefault(),e(),d.find("a").removeClass("active")}),new Hametuha.views.Scroll;var f,g,h=a("#single-radar");h.length&&(Modernizr.canvas?(f=h.get(0).getContext("2d"),g=new Chart(f).Radar(postScore,{})):h.replaceWith('<p class="alert alert-danger">Canvasに対応していないため、ご利用の環境ではレーダーチャートを表示できません。</p>')),a(document).on("submit","#review-form",function(b){b.preventDefault();var c=a(this).find("input[type=submit]");c.button("loading"),a(this).ajaxSubmit({dataType:"json",success:function(a){c.button("reset"),a.error?Hametuha.alert(a.message,!0):(Hametuha.alert(a.message),c.button("complete"),a.guest&&setTimeout(function(){c.attr("disabled",!0)},50))},error:function(){Hametuha.alert("評価を送信できませんでした。",!0),c.button("reset")}})}),a(document).on("click",".star-rating i",function(){var b=parseInt(a(this).attr("data-value"),10);a(".star-rating i").each(function(c,d){parseInt(a(d).attr("data-value"),10)<=b?a(d).addClass("active"):a(d).removeClass("active")}),a(this).nextAll("input[type=hidden]").val(b)}),a(document).on("created.hametuha",".list-create-form",function(b,c){a("#list-changer").append('<div class="checkbox"><label><input type="checkbox" name="lists[]" value="'+c.ID+'" checked>'+("private"===c.post_status?"非公開: ":"公開　: ")+c.post_title+"</label></div>")})})}(jQuery);
//# sourceMappingURL=single-post.min.js.map